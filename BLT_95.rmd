---
title: "BLT_9.5"
author: "Manjula Kottegoda"
date: "July 13, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Preparing Financial Data

Assignment
Half of you will be assigned to find a series that is less volatile than the S&P 500, the other half a series that is more volatile.
Download the data.
Calculate log returns.
Calculate volatility measure.
Calculate volatility over entire length of series for various three different decay factors.
Plot the results, overlaying the volatility curves on the data, 

```{r}
require("tseries")

#Download data series
SNPdata <- get.hist.quote('^gspc',quote="Close")
# see length of data
length(SNPdata)
# Calculate log returns
SNPret <- log(lag(SNPdata)) - log(SNPdata)
length(SNPret)
# Calculate Volatility for 250 trading days
SNPvol <- sd(SNPret) * sqrt(250) *100

Vol <- function(d, logrets){
      var = 0
      lam = 0
      varlist <- c()
      for (r in logrets){
        
        lam = lam * (1 - 1/d) +1 
        
        var = (1 - 1/lam)*var+ (1/lam)*r^2
            varlist <- c(varlist, var)
      }
    sqrt(varlist)
}


# Calculating for 3 decay factors
volest <- Vol(10, SNPret)
volest2 <- Vol(50, SNPret)
volest3 <- Vol(200, SNPret)


plot(volest,type='l')
lines(volest2,type='l', col = 'red')
lines(volest3,type='l', col = 'blue') # smooth with higher weight
```

